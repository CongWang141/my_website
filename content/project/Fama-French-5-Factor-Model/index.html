---
title: "Fama-French Five Factor Model"
author: "Cong Wang"
date: "2022-08-02"
output:
  html_document:
    toc: true
    number_sections: true
    toc_float: true
excerpt: Fama-French Five Factor Model is an extension of the classic CAPM to include SMB (Small Minus Big), 	HML (High Minus Low), RMW (Robust Minus Weak), and CMA (Conservative Minus Aggressive).

tags: 
- R
categories:
- Financial models

draft: false

---



<style type="text/css">
  h1,h2,h3{
  font-size: 16pt;
  color: steelblue
}
</style>
<div id="model-introduction" class="section level1">
<h1>Model Introduction</h1>
<p>Fama-French Five Factor Model is an extension of the classic CAPM to include SMB (Small Minus Big), HML (High Minus Low), RMW (Robust Minus Weak), and CMA (Conservative Minus Aggressive).</p>
<p>The Fama/French 5 factors (2x3) are constructed using the 6 value-weight portfolios formed on size and book-to-market, the 6 value-weight portfolios formed on size and operating profitability, and the 6 value-weight portfolios formed on size and investment.</p>
<ol style="list-style-type: decimal">
<li>SMB (Small Minus Big) is the average return on the nine small stock portfolios minus the average return on the nine big stock portfolios.</li>
<li>HML (High Minus Low) is the average return on the two value portfolios minus the average return on the two growth portfolios.</li>
<li>RMW (Robust Minus Weak) is the average return on the two robust operating profitability portfolios minus the average return on the two weak operating profitability portfolios.</li>
<li>CMA (Conservative Minus Aggressive) is the average return on the two conservative investment portfolios minus the average return on the two aggressive investment portfolios.</li>
<li>R<sub>m</sub>-R<sub>f</sub>, the excess return on the market, value-weight return of all CRSP firms incorporated in the US and listed on the NYSE, AMEX, or NASDAQ.</li>
</ol>
</div>
<div id="data-import" class="section level1">
<h1>Data Import</h1>
<div id="the-five-factors-daily-data" class="section level2">
<h2>The Five Factors Daily Data</h2>
<p>The five factors daily data is from the link here: <a href="http://mba.tuck.dartmouth.edu/pages/faculty/ken.french/data_library.html" class="uri">http://mba.tuck.dartmouth.edu/pages/faculty/ken.french/data_library.html</a>, you can also download it directly through the <a href="http://mba.tuck.dartmouth.edu/pages/faculty/ken.french/ftp/F-F_Research_Data_5_Factors_2x3_daily_CSV.zip">link</a>.</p>
<p>Here I import the data from the unfolded zip file,</p>
<pre class="r"><code>library(readr)
ffd &lt;- read_csv(&quot;F-F_Research_Data_5_Factors_2x3_daily.CSV&quot;, skip = 3)
head(ffd, 5)</code></pre>
<pre><code>## # A tibble: 5 × 7
##       ...1 `Mkt-RF`   SMB   HML   RMW   CMA    RF
##      &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 19630701    -0.67  0.01 -0.35  0.03  0.11 0.012
## 2 19630702     0.79 -0.31  0.24 -0.08 -0.25 0.012
## 3 19630703     0.63 -0.16 -0.09  0.13 -0.24 0.012
## 4 19630705     0.4   0.09 -0.26  0.07 -0.28 0.012
## 5 19630708    -0.63  0.07 -0.19 -0.27  0.06 0.012</code></pre>
<p>Change the first column’s name.</p>
<pre class="r"><code>colnames(ffd)[1] &lt;- &quot;Date&quot;
head(ffd, 5)</code></pre>
<pre><code>## # A tibble: 5 × 7
##       Date `Mkt-RF`   SMB   HML   RMW   CMA    RF
##      &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 19630701    -0.67  0.01 -0.35  0.03  0.11 0.012
## 2 19630702     0.79 -0.31  0.24 -0.08 -0.25 0.012
## 3 19630703     0.63 -0.16 -0.09  0.13 -0.24 0.012
## 4 19630705     0.4   0.09 -0.26  0.07 -0.28 0.012
## 5 19630708    -0.63  0.07 -0.19 -0.27  0.06 0.012</code></pre>
</div>
<div id="amazon-stock-data" class="section level2">
<h2>Amazon Stock Data</h2>
<p>Here I use the Amazon stock price data as an example. It is downloaded through the <strong>quantmod</strong> package.</p>
<pre class="r"><code>library(quantmod)
amazon &lt;- getSymbols(&quot;AMZN&quot;, from=&quot;2010-01-01&quot;, to=&quot;2022-08-01&quot;, auto.assign = F)</code></pre>
<p>Calculate the daily return.</p>
<pre class="r"><code>amazon$return1 &lt;- dailyReturn(amazon$AMZN.Close, type = &quot;log&quot;)</code></pre>
<p>Or we can use this to get the exactly the same result.</p>
<pre class="r"><code>amazon$return2 &lt;- (amazon$AMZN.Close-stats::lag(amazon$AMZN.Close))/stats::lag(amazon$AMZN.Close)</code></pre>
<pre class="r"><code>head(amazon[, 7:8], 5)</code></pre>
<pre><code>##                 return1      return2
## 2010-01-04  0.000000000           NA
## 2010-01-05  0.005882589  0.005899925
## 2010-01-06 -0.018281771 -0.018115673
## 2010-01-07 -0.017159620 -0.017013233
## 2010-01-08  0.026716829  0.027076923</code></pre>
</div>
<div id="meger-the-stock-return-data-with-the-five-factors-data" class="section level2">
<h2>Meger the stock return data with the five factors data</h2>
<pre class="r"><code>amazon_ret &lt;- amazon$return1
amazon_ret2 &lt;- fortify.zoo(amazon_ret)
colnames(amazon_ret2)[1] &lt;- &quot;Date&quot;
library(lubridate)
ffd$Date &lt;- ymd(ffd$Date)
library(tidyverse)
data_merged &lt;- left_join(amazon_ret2, ffd, by=&quot;Date&quot;)</code></pre>
<pre class="r"><code>head(data_merged, 5)</code></pre>
<pre><code>##         Date      return1 Mkt-RF   SMB  HML   RMW   CMA RF
## 1 2010-01-04  0.000000000   1.69  0.79 1.13 -0.18  0.21  0
## 2 2010-01-05  0.005882589   0.31 -0.41 1.24 -0.20  0.19  0
## 3 2010-01-06 -0.018281771   0.13 -0.13 0.57 -0.05  0.20  0
## 4 2010-01-07 -0.017159620   0.40  0.25 0.98 -0.69  0.22  0
## 5 2010-01-08  0.026716829   0.33  0.32 0.01  0.22 -0.37  0</code></pre>
<p>Plot the return</p>
<pre class="r"><code>library(ggplot2)
p1 &lt;- ggplot(amazon_ret2[-1, ], aes(x=Date, y=return1))
p1 + geom_line(color=&quot;steelblue&quot;)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>Density plot with normal density curve</p>
<pre class="r"><code>p2 &lt;- ggplot(amazon_ret2)
p2 + geom_histogram(mapping = aes(x=return1, y=..density..), binwidth=0.005, color=&quot;steelblue&quot;, fill=&quot;grey&quot;, size=1) +
  stat_function(fun = dnorm, args = list(mean = mean(amazon_ret2$return1, na.rm = T), sd = sd(amazon_ret2$return1, na.rm = T)), size=1)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
</div>
</div>
<div id="regress-amazons-stock-return-on-the-five-factors" class="section level1">
<h1>Regress Amazon’s stock return on the five factors</h1>
<pre class="r"><code>names(data_merged)[3] &lt;- &quot;Mkt.RF&quot;
fit &lt;- lm(return1 ~  SMB + HML  + CMA + Mkt.RF + RMW, data = data_merged)
fit2 &lt;- lm(return1 ~  SMB + HML + CMA + Mkt.RF, data = data_merged)</code></pre>
<pre class="r"><code>library(stargazer)
stargazer(fit, fit2, title = &quot;Fama-French Five Factor Regression OLS&quot;, type=&quot;text&quot;)</code></pre>
<pre><code>## 
## Fama-French Five Factor Regression OLS
## =======================================================================
##                                     Dependent variable:                
##                     ---------------------------------------------------
##                                           return1                      
##                                (1)                       (2)           
## -----------------------------------------------------------------------
## SMB                         -0.002***                 -0.002***        
##                             (0.0005)                  (0.0005)         
##                                                                        
## HML                         -0.004***                 -0.004***        
##                             (0.0005)                  (0.0005)         
##                                                                        
## CMA                         -0.009***                 -0.009***        
##                              (0.001)                   (0.001)         
##                                                                        
## Mkt.RF                      0.011***                  0.011***         
##                             (0.0003)                  (0.0003)         
##                                                                        
## RMW                          0.00000                                   
##                              (0.001)                                   
##                                                                        
## Constant                     0.0004                    0.0004          
##                             (0.0003)                  (0.0003)         
##                                                                        
## -----------------------------------------------------------------------
## Observations                  3,145                     3,145          
## R2                            0.453                     0.453          
## Adjusted R2                   0.452                     0.452          
## Residual Std. Error     0.015 (df = 3139)         0.015 (df = 3140)    
## F Statistic         519.464*** (df = 5; 3139) 649.537*** (df = 4; 3140)
## =======================================================================
## Note:                                       *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</code></pre>
<p>Plot the regression</p>
<pre class="r"><code>par(mar = c(2, 2, 2, 2))
par(mfrow = c(2, 2))
plot(fit)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<pre class="r"><code>par(mar = c(2, 2, 2, 2))
par(mfrow = c(2, 2))
plot(fit2)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
