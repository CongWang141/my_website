---
title: "Global Carbon Emission Analysis"
author: "Cong Wang"
date: "2022-07-30"

excerpt: This airticle analyize the globle carobon emission. The data for this analysis is from **World Bank Open Data**, collected since 1990. It breaks down the global carbon emission and decomposes the trend.
tags: 
- Carbon Emission

categories: 
- Climate Change

featured: true
layout: single
---



<div id="motivation" class="section level1">
<h1>Motivation</h1>
<p>Global warming has been brought up a long time ago, but it never draws most people’s attention not even me till recently. Since 2020, the wild fires in Austrilia and north America terrified me a lot. In 2022, heat wave stroms most places all around the world. Human activities could be one of the main reseasons for those catastraphic climate problems. Carbon emission is considered a good proxy to quantify the influence of human activities to global warming. This airticle tries to give some insights about the current status and historical change of global carbon emission.</p>
</div>
<div id="data-sourse" class="section level1">
<h1>Data Sourse</h1>
<p>The data for this analysis is from <strong>World Bank Open Data</strong>, link: <a href="https://data.worldbank.org/" class="uri">https://data.worldbank.org/</a></p>
<p>To download the <a href="https://api.worldbank.org/v2/en/indicator/EN.ATM.CO2E.KT?downloadformat=csv">CSV.file</a>, you will get:</p>
<ol style="list-style-type: decimal">
<li>each country’s carbon emission data</li>
<li>country metadata</li>
<li>indicator metadata</li>
</ol>
</div>
<div id="data-exploration" class="section level1">
<h1>Data exploration</h1>
<p>Import each country’s carbon emission data.</p>
<pre class="r"><code>d &lt;- read.csv(&quot;API_EN.ATM.CO2E.KT_DS2_en_csv_v2_4354173.csv&quot;, skip = 3)</code></pre>
<p>Carbon emission data is collected since 1990, the year before that shows NA, we need to remove the year without data and remove variables we do not need.</p>
<pre class="r"><code>library(tidyverse)</code></pre>
<p>Build a function to choose columns which are not all data are NA. Then select those columns to a new dataset.</p>
<pre class="r"><code>not_all_na &lt;- function(x) any(!is.na(x))
d_comp &lt;- select(d, where(not_all_na),
                            -&quot;Indicator.Name&quot;, -&quot;Indicator.Code&quot;)</code></pre>
<div id="co2-emission-for-the-whole-world." class="section level2 tabset">
<h2>Co2 emission for the whole world.</h2>
<p>The world total carbon emission is contained in the data, with country name <em>World</em>.</p>
<p>Pick out the data for <strong>World</strong>, convert it into panel data.</p>
<pre class="r"><code>world &lt;- d_comp[d_comp$Country.Name == &quot;World&quot;, ]
world_p &lt;- pivot_longer(world, names_to = &quot;year&quot;, values_to = &quot;co2&quot;,
                               cols = starts_with(&quot;X&quot;))</code></pre>
<p>Remove the X in front of each year, and declare it is number.</p>
<pre class="r"><code>world_p$year &lt;- as.numeric(substr(world_p$year, 2, 5))</code></pre>
<div id="use-ggplot2." class="section level3">
<h3>Use ggplot2.</h3>
<pre class="r"><code>library(ggplot2)
p1 &lt;- ggplot(data = world_p, aes(x = year, y = co2/1000000))
p1 + geom_line(color = &quot;steelblue&quot;) +
  scale_x_continuous(breaks = seq(1988, 2021, 2)) +
  scale_y_continuous(breaks = seq(17, 34, 2)) + ylab(&quot;Co2&quot;) +
  ggtitle(&quot;in million&quot;)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
</div>
<div id="yoy-change-in-percentage." class="section level3">
<h3>YOY Change in percentage.</h3>
<p>Calculate the year over year change of carbon emission.</p>
<pre class="r"><code>world_p$change &lt;- (world_p$co2-dplyr::lag(world_p$co2))/dplyr::lag(world_p$co2)*100 </code></pre>
<pre class="r"><code>p1.1 &lt;- ggplot(data = world_p, aes(x=year, y=change))
p1.1 + geom_line(color=&quot;steelblue&quot;) + 
  scale_x_continuous(breaks=seq(1988,2021,2))+
ylab(&quot;YOY Change of Co2 Emission&quot;) + 
  ggtitle(&quot;In Percentage&quot;)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
</div>
</div>
<div id="co2-emission-in-different-area" class="section level2 tabset">
<h2>Co2 emission in different area</h2>
<p>Except for the world total carbon emission, different geographic area’s carbon emission is also collected in the data.</p>
<p>Get total carbon emission for each row through all time</p>
<pre class="r"><code>d_comp$co2_total &lt;- rowSums(d_comp[ ,3:32])
d_comp &lt;- arrange(d_comp, desc(co2_total)) </code></pre>
<p>Pick geographic area.</p>
<pre class="r"><code>co2_area &lt;- d_comp[d_comp$Country.Name %in% c(&quot;East Asia &amp; Pacific&quot;, &quot;North America&quot;, &quot;Euro area&quot;, &quot;Middle East &amp; North Africa&quot;, &quot;South Asia&quot;, &quot;Latin America &amp; Caribbean&quot;, &quot;Sub-Saharan Africa&quot;), ]</code></pre>
<p>Convert dataset to panel data.</p>
<pre class="r"><code>co2_area_p &lt;- pivot_longer(co2_area, names_to=&quot;year&quot;, values_to = &quot;co2&quot;, cols = starts_with(&quot;X&quot;))
co2_area_p$year &lt;- as.numeric(substr(co2_area_p$year, 2, 5)) 
co2_area_p &lt;- arrange(co2_area_p, desc(co2_total))</code></pre>
<div id="line-plot." class="section level3 unnumbered">
<h3>Line Plot.</h3>
<pre class="r"><code>p2 &lt;- ggplot(data = co2_area_p, aes(x=year, y=co2/1000000, color=Country.Name))
p2 + geom_line() + 
  scale_x_continuous(breaks=seq(1988,2021,4))+
  scale_y_continuous(breaks=seq(0, 16, 2)) + ylab(&quot;Co2&quot;) + 
  ggtitle(&quot;in million&quot;) +
  theme(legend.position=&quot;bottom&quot;, legend.title = element_blank())</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="bar-plot." class="section level3 unnumbered">
<h3>Bar Plot.</h3>
<pre class="r"><code>p3 &lt;- ggplot(data = co2_area_p, aes(x=reorder(Country.Name, -co2_total), y=co2_total/1000000))
p3 + geom_bar(stat=&quot;identity&quot;, fill=&quot;steelblue&quot;) + 
  ggtitle(&quot;in million&quot;) +  ylab(&quot;Total Co2 Emission&quot;) + xlab(&quot;Geographic Areas&quot;) +
  theme(axis.text.x = element_text(angle = 30, hjust = 1)) </code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
<div id="yoy-change" class="section level3 unnumbered">
<h3>YOY Change</h3>
<p>Group the data <em>co2_area_p</em> by country name, in each group calculate the year over year carbon emission change in percentage.</p>
<pre class="r"><code>co2_area_p %&gt;%
  group_by(Country.Name) %&gt;%
  summarise((co2-dplyr::lag(co2))/dplyr::lag(co2)*100) -&gt; co2_area_p$change</code></pre>
<p>By using “group_by” and “summarise”, R will generate a dataset under variable “change”, we need to handle it.</p>
<pre class="r"><code>co2_area_p$change &lt;- co2_area_p$change$`(co2 - dplyr::lag(co2))/dplyr::lag(co2) * 100`</code></pre>
<p>Plot the data</p>
<pre class="r"><code>p2.1 &lt;- ggplot(data = co2_area_p, aes(x=year, y=change, color=Country.Name))
p2.1 + geom_line() + 
  scale_x_continuous(breaks=seq(1988,2021,4))+
ylab(&quot;YOY Co2 Emission Change&quot;) + 
  ggtitle(&quot;In Percentage&quot;) +
  theme(legend.position=&quot;bottom&quot;, legend.title = element_blank())</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
</div>
</div>
<div id="co2-emission-for-top-10-countries" class="section level2 tabset">
<h2>Co2 emission for top 10 countries</h2>
<p>Get carbon emission for top 10 countries through all time.</p>
<pre class="r"><code>country_data &lt;- d_comp[c(15, 17, 30, 32, 36, 43:266), ]
country_10 &lt;- country_data[c(1:8, 10:11), ]</code></pre>
<p>Convert it to panel data</p>
<pre class="r"><code>country_10_pan &lt;- pivot_longer(country_10, names_to=&quot;year&quot;, values_to = &quot;co2&quot;, cols = starts_with(&quot;X&quot;))
country_10_pan$year &lt;- as.numeric(substr(country_10_pan$year, 2, 5)) </code></pre>
<div id="line-plot-for-top-10-countries." class="section level3 unnumbered">
<h3>Line Plot for top 10 countries.</h3>
<pre class="r"><code>p4 &lt;- ggplot(data = country_10_pan, aes(x=year, y=co2/1000000, color=Country.Name))
p4 + geom_line() + 
  scale_x_continuous(breaks=seq(1988,2021,4))+
  scale_y_continuous(breaks=seq(0, 16, 2)) + ylab(&quot;Co2&quot;) + 
  ggtitle(&quot;in million&quot;) +
  theme(legend.position=&quot;bottom&quot;, legend.title = element_blank())</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
</div>
<div id="bar-plot-for-top-10-countries." class="section level3 unnumbered">
<h3>Bar Plot for top 10 countries.</h3>
<pre class="r"><code>p5 &lt;- ggplot(data = country_10_pan, aes(x=reorder(Country.Name, -co2_total), y=co2_total/1000000))
p5 + geom_bar(stat=&quot;identity&quot;, fill=&quot;steelblue&quot;) + 
  ggtitle(&quot;in million&quot;) +  ylab(&quot;Total Co2 Emission&quot;) + xlab(&quot;Country&quot;) +
  theme(axis.text.x = element_text(angle = 30, hjust = 1)) </code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
</div>
<div id="yoy-change-for-top-10-countries." class="section level3 unnumbered">
<h3>YoY Change for top 10 countries.</h3>
<pre class="r"><code>country_10_pan %&gt;%
  group_by(Country.Name) %&gt;%
  summarise((co2-dplyr::lag(co2))/dplyr::lag(co2)*100) -&gt; country_10_pan$change</code></pre>
<pre class="r"><code>country_10_pan$change &lt;- country_10_pan$change$`(co2 - dplyr::lag(co2))/dplyr::lag(co2) * 100`</code></pre>
<p>Plot the data</p>
<pre class="r"><code>p2.1 &lt;- ggplot(data = country_10_pan, aes(x=year, y=change, color=Country.Name))
p2.1 + geom_line() + 
  scale_x_continuous(breaks=seq(1988,2021,4))+
ylab(&quot;YOY Co2 Emission Change&quot;) + 
  ggtitle(&quot;In Percentage&quot;) +
  theme(legend.position=&quot;bottom&quot;, legend.title = element_blank())</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="yoy-change-for-top-5-countries." class="section level3 unnumbered">
<h3>YoY Change for top 5 countries.</h3>
<pre class="r"><code>p2.2 &lt;- ggplot(data = country_10_pan[1:150, ], aes(x=year, y=change, color=Country.Name))
p2.2 + geom_line() + 
  scale_x_continuous(breaks=seq(1988,2021,4))+
ylab(&quot;YOY Co2 Emission Change&quot;) + 
  ggtitle(&quot;In Percentage&quot;) +
  theme(legend.position=&quot;bottom&quot;, legend.title = element_blank())</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
</div>
</div>
</div>
